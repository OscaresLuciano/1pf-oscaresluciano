"use strict";(self.webpackChunkPF_OscaresLuciano=self.webpackChunkPF_OscaresLuciano||[]).push([[357],{6357:(pt,x,n)=>{n.r(x),n.d(x,{UsuariosModule:()=>dt});var c=n(6895),S=n(2559),f=n(6582),r=n(4006),d=n(5412),w=n(5226),v=n.n(w);const J={Administrador:"Administrador",Empleado:"Empleado",Estudiante:"Estudiante",Profesor:"Profesor"};var t=n(4650),U=n(4351),p=n(4004),Z=n(9646),h=n(6497);function A(e){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let o="";for(let i=0;i<e;i++){const s=Math.floor(Math.random()*a.length);o+=a.charAt(s)}return o}var k=n(529);let C=(()=>{class e{constructor(o){this.httpClient=o,this.usuarios=[]}getUsuarios$(){return this.httpClient.get(`${h.N.baseUrl}/users`)}createUsuarios$(o){const s={...o,token:A(20)};return this.httpClient.post(`${h.N.baseUrl}/users`,s).pipe((0,U.b)(()=>this.getUsuarios$()))}deleteUsuarios$(o){return this.httpClient.delete(`${h.N.baseUrl}/users/${o}`).pipe((0,U.b)(()=>this.getUsuarios$()))}editUsuarios$(o,i){const u={...i,token:A(20)};return this.httpClient.put(`${h.N.baseUrl}/users/${o}`,u).pipe((0,U.b)(()=>this.getUsuarios$()))}getUsuarioWithInscripciones$(o){return this.getUsuarioById$(o).pipe((0,U.b)(i=>i?this.httpClient.get(`${h.N.baseUrl}/enrollments?userId=${o}&_expand=course&_expand=user`).pipe((0,p.U)(s=>({usuario:i,inscripciones:s}))):(0,Z.of)({usuario:void 0,inscripciones:[]})))}getUsuarioById$(o){return this.httpClient.get(`${h.N.baseUrl}/users/${o}`)}static#t=this.\u0275fac=function(i){return new(i||e)(t.LFG(k.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var T=n(4859),E=n(4144),_=n(9549),M=n(4385),O=n(3238),q=n(9228);function R(e,a){if(1&e&&(t.TgZ(0,"mat-option",16),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=a.$implicit;t.Q6J("value",o),t.xp6(1),t.hij(" ",t.lcZ(2,2,o)," ")}}let $=(()=>{class e{constructor(o,i,s){this.matDialogRef=o,this.usuariosService=i,this.usuarioId=s,this.userRoles=Object.keys(J),this.nameControl=new r.NI("",[r.kI.required,r.kI.minLength(4),r.kI.maxLength(20)]),this.lastnameControl=new r.NI("",[r.kI.required,r.kI.minLength(4),r.kI.maxLength(20)]),this.emailControl=new r.NI("",[r.kI.required,r.kI.email,r.kI.minLength(4),r.kI.maxLength(30)]),this.passwordControl=new r.NI("",[r.kI.required,r.kI.minLength(4),r.kI.maxLength(30)]),this.roleControl=new r.NI("",[r.kI.required]),this.usuarioForm=new r.cw({name:this.nameControl,lastName:this.lastnameControl,email:this.emailControl,password:this.passwordControl,role:this.roleControl}),s&&this.usuariosService.getUsuarioById$(s).subscribe({next:u=>{u&&this.usuarioForm.patchValue(u)}})}get isEditing(){return!!this.usuarioId}onSubmit(){this.usuarioForm.invalid?this.usuarioForm.markAllAsTouched():(this.matDialogRef.close(this.usuarioForm.value),v().fire("",this.isEditing?"Usuario editado correctamente!":"Usuario agregado correctamente!","success"))}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(d.so),t.Y36(C),t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-usuarios-modal"]],decls:51,vars:18,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"w-100"],["formControlName","name","matInput","","type","text"],["formControlName","lastName","matInput","","type","text"],["formControlName","email","matInput","","type","email"],["formControlName","password","matInput","","type","password"],[1,"col-12"],["formControlName","role"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-flat-button","","color","primary",3,"click"],["mat-flat-button","","mat-dialog-close","","color","warn"],[3,"value"]],template:function(i,s){if(1&i&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),t._uU(8,"Nombre"),t.qZA(),t._UZ(9,"input",6),t.TgZ(10,"mat-error"),t._uU(11),t.ALo(12,"formErrors"),t.qZA()()(),t.TgZ(13,"div",4)(14,"mat-form-field",5)(15,"mat-label"),t._uU(16,"Apellido"),t.qZA(),t._UZ(17,"input",7),t.TgZ(18,"mat-error"),t._uU(19),t.ALo(20,"formErrors"),t.qZA()()(),t.TgZ(21,"div",4)(22,"mat-form-field",5)(23,"mat-label"),t._uU(24,"Email"),t.qZA(),t._UZ(25,"input",8),t.TgZ(26,"mat-error"),t._uU(27),t.ALo(28,"formErrors"),t.qZA()()(),t.TgZ(29,"div",4)(30,"mat-form-field",5)(31,"mat-label"),t._uU(32,"Password"),t.qZA(),t._UZ(33,"input",9),t.TgZ(34,"mat-error"),t._uU(35),t.ALo(36,"formErrors"),t.qZA()()(),t.TgZ(37,"div",10)(38,"mat-form-field",5)(39,"mat-label"),t._uU(40,"Rol"),t.qZA(),t.TgZ(41,"mat-select",11),t.YNc(42,R,3,4,"mat-option",12),t.qZA(),t.TgZ(43,"mat-error"),t._uU(44),t.ALo(45,"formErrors"),t.qZA()()()()()(),t.TgZ(46,"div",13)(47,"button",14),t.NdJ("click",function(){return s.onSubmit()}),t._uU(48,"Guardar"),t.qZA(),t.TgZ(49,"button",15),t._uU(50,"Cancelar"),t.qZA()()),2&i){let u,l,D,F,L;t.xp6(1),t.hij(" ",s.isEditing?"Editar usuario":"Crear usuario","\n"),t.xp6(2),t.Q6J("formGroup",s.usuarioForm),t.xp6(8),t.hij(" ",t.lcZ(12,8,null==(u=s.usuarioForm.get("name"))?null:u.errors)," "),t.xp6(8),t.hij(" ",t.lcZ(20,10,null==(l=s.usuarioForm.get("lastName"))?null:l.errors)," "),t.xp6(8),t.hij(" ",t.lcZ(28,12,null==(D=s.usuarioForm.get("email"))?null:D.errors)," "),t.xp6(8),t.hij(" ",t.lcZ(36,14,null==(F=s.usuarioForm.get("password"))?null:F.errors)," "),t.xp6(7),t.Q6J("ngForOf",s.userRoles),t.xp6(2),t.hij(" ",t.lcZ(45,16,null==(L=s.usuarioForm.get("role"))?null:L.errors)," ")}},dependencies:[c.sg,T.lW,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,E.Nt,_.KE,_.hX,_.TO,d.ZT,d.uh,d.xY,d.H8,M.gD,O.ey,c.rS,q.w],encapsulation:2})}return e})();var b=n(7392),y=n(5828),I=n(7569),N=n(9653),m=n(7155),Y=n(3582);function Q(e,a){1&e&&(t.TgZ(0,"th",11),t._uU(1,"ID"),t.qZA())}function j(e,a){if(1&e&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.id)}}function B(e,a){1&e&&(t.TgZ(0,"th",11),t._uU(1,"Nombre Completo"),t.qZA())}function z(e,a){if(1&e&&(t.TgZ(0,"td",12),t._uU(1),t.ALo(2,"fullName"),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o,"uppercase")," ")}}function W(e,a){1&e&&(t.TgZ(0,"th",11),t._uU(1,"Email"),t.qZA())}function H(e,a){if(1&e&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&e){const o=a.$implicit;t.xp6(1),t.Oqu(o.email)}}function P(e,a){1&e&&(t.TgZ(0,"th",13),t._uU(1,"Acciones"),t.qZA())}function G(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"td",14)(1,"button",15)(2,"mat-icon"),t._uU(3," visibility "),t.qZA()(),t.TgZ(4,"button",16),t.NdJ("click",function(){const u=t.CHM(o).$implicit,l=t.oxw();return t.KtG(l.editUsuario.emit(u))}),t.ALo(5,"async"),t.TgZ(6,"mat-icon"),t._uU(7," edit "),t.qZA()(),t.TgZ(8,"button",17),t.NdJ("click",function(){const u=t.CHM(o).$implicit,l=t.oxw();return t.KtG(l.deleteUsuario.emit(u.id))}),t.ALo(9,"async"),t.TgZ(10,"mat-icon"),t._uU(11," delete "),t.qZA()()()}if(2&e){const o=a.$implicit,i=t.oxw();t.xp6(1),t.Q6J("routerLink",o.id),t.xp6(3),t.Q6J("disabled","Administrador"!==t.lcZ(5,3,i.usuarioRol$)),t.xp6(4),t.Q6J("disabled","Administrador"!==t.lcZ(9,5,i.usuarioRol$))}}function K(e,a){1&e&&t._UZ(0,"tr",18)}function X(e,a){1&e&&t._UZ(0,"tr",19)}let V=(()=>{class e{constructor(o){this.store=o,this.dataSource=[],this.deleteUsuario=new t.vpe,this.editUsuario=new t.vpe,this.displayedColumns=["id","fullname","email","actions"],this.usuarioRol$=this.store.select(I.r).pipe((0,p.U)(i=>i?.role))}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(N.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-usuarios-table"]],inputs:{dataSource:"dataSource"},outputs:{deleteUsuario:"deleteUsuario",editUsuario:"editUsuario"},decls:15,vars:3,consts:[["mat-table","",1,"mat-elevation-z8","text-center",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fullname"],["matColumnDef","email"],["matColumnDef","actions"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"text-center"],["mat-cell","",1,"text-center"],["mat-icon-button","","color","primary",3,"routerLink"],["mat-icon-button","","color","accent",3,"disabled","click"],["mat-icon-button","","color","warn",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(i,s){1&i&&(t.TgZ(0,"table",0),t.ynx(1,1),t.YNc(2,Q,2,0,"th",2),t.YNc(3,j,2,1,"td",3),t.BQk(),t.ynx(4,4),t.YNc(5,B,2,0,"th",2),t.YNc(6,z,3,4,"td",3),t.BQk(),t.ynx(7,5),t.YNc(8,W,2,0,"th",2),t.YNc(9,H,2,1,"td",3),t.BQk(),t.ynx(10,6),t.YNc(11,P,2,0,"th",7),t.YNc(12,G,12,7,"td",8),t.BQk(),t.YNc(13,K,1,0,"tr",9),t.YNc(14,X,1,0,"tr",10),t.qZA()),2&i&&(t.Q6J("dataSource",s.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns))},dependencies:[b.Hw,T.RK,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,f.rH,c.Ov,Y.k],encapsulation:2})}return e})();const tt=function(){return[]};let et=(()=>{class e{constructor(o,i){this.usuariosService=o,this.matDialog=i,this.usuarios$=this.usuariosService.getUsuarios$()}addUsuario(){this.matDialog.open($).afterClosed().subscribe({next:o=>{o&&(this.usuarios$=this.usuariosService.createUsuarios$(o))}})}onDeleteUsuario(o){v().fire({title:"Confirmar eliminaci\xf3n",text:"Est\xe1s seguro de borrar este usuario?",icon:"question",showCancelButton:!0,confirmButtonText:"S\xed, eliminar usuario",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&(this.usuarios$=this.usuariosService.deleteUsuarios$(o))})}onEditUsuario(o){this.matDialog.open($,{data:o.id}).afterClosed().subscribe({next:i=>{i&&(this.usuarios$=this.usuariosService.editUsuarios$(o.id,i))}})}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(C),t.Y36(d.uw))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-usuarios"]],decls:9,vars:4,consts:[["appTextSize","","fontWeight","500"],[1,"pb-3"],["mat-flat-button","","color","primary",3,"click"],[3,"dataSource","deleteUsuario","editUsuario"]],template:function(i,s){1&i&&(t.TgZ(0,"h1",0),t._uU(1,"Usuarios"),t.qZA(),t.TgZ(2,"div",1)(3,"button",2),t.NdJ("click",function(){return s.addUsuario()}),t.TgZ(4,"mat-icon"),t._uU(5,"add"),t.qZA(),t._uU(6,"Crear Usuario "),t.qZA()(),t.TgZ(7,"app-usuarios-table",3),t.NdJ("deleteUsuario",function(l){return s.onDeleteUsuario(l)})("editUsuario",function(l){return s.onEditUsuario(l)}),t.ALo(8,"async"),t.qZA()),2&i&&(t.xp6(7),t.Q6J("dataSource",t.lcZ(8,1,s.usuarios$)||t.DdM(3,tt)))},dependencies:[b.Hw,T.lW,y.Y,V,c.Ov],encapsulation:2})}return e})();var ot=n(2092),g=n(3546),it=n(4850);function st(e,a){if(1&e&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=t.oxw().ngIf;t.xp6(1),t.hij(" Tipo de usuario: ",t.lcZ(2,1,o.role)," ")}}function nt(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"li",8)(1,"p",9),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.ALo(8,"date"),t.qZA(),t.TgZ(9,"mat-card-actions")(10,"button",10),t.NdJ("click",function(){const u=t.CHM(o).$implicit,l=t.oxw(4);return t.KtG(l.eliminarInscripcion(u.id))}),t._uU(11," Eliminar inscripcion "),t.qZA()(),t._UZ(12,"mat-divider",11),t.qZA()}if(2&e){const o=a.$implicit;t.xp6(2),t.hij("- ",null==o.course?null:o.course.name,""),t.xp6(2),t.hij(" Fecha de inicio: ",t.xi3(5,3,null==o.course?null:o.course.startDate,"dd/MM/YYYY")," "),t.xp6(3),t.hij(" Fecha de finalizaci\xf3n: ",t.xi3(8,6,null==o.course?null:o.course.endDate,"dd/MM/YYYY")," ")}}function at(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-card",2)(2,"mat-card-title"),t._uU(3," Inscripciones: "),t.qZA(),t.TgZ(4,"ul",6),t.YNc(5,nt,13,9,"li",7),t.ALo(6,"async"),t.qZA()(),t.BQk()),2&e){const o=t.oxw(3);t.xp6(5),t.Q6J("ngForOf",t.lcZ(6,1,o.inscripciones$))}}function rt(e,a){if(1&e&&(t.ynx(0),t.YNc(1,at,7,3,"ng-container",5),t.BQk()),2&e){const o=a.ngIf;t.oxw();const i=t.MAs(15);t.xp6(1),t.Q6J("ngIf",o.length>0)("ngIfElse",i)}}function ut(e,a){}function lt(e,a){if(1&e&&(t.TgZ(0,"div")(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title")(4,"p"),t._uU(5),t.ALo(6,"fullName"),t.qZA()()(),t.TgZ(7,"mat-card-content",3)(8,"p"),t._uU(9),t.qZA(),t.YNc(10,st,3,3,"p",1),t.ALo(11,"async"),t.YNc(12,rt,2,2,"ng-container",1),t.ALo(13,"async"),t.YNc(14,ut,0,0,"ng-template",null,4,t.W1O),t.qZA()()()),2&e){const o=a.ngIf,i=t.oxw();t.xp6(5),t.Oqu(t.xi3(6,4,o,"uppercase")),t.xp6(4),t.hij("Email: ",o.email,""),t.xp6(1),t.Q6J("ngIf","Administrador"===t.lcZ(11,7,i.usuarioRol$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(13,9,i.inscripciones$))}}const ct=[{path:"",component:et},{path:":id",component:(()=>{class e{constructor(o,i,s,u){this.activatedRoute=o,this.usuariosService=i,this.inscripcionesService=s,this.store=u,this.usuario$=(0,Z.of)(void 0),this.inscripciones$=(0,Z.of)([]),this.usuarioRol$=this.store.select(I.r).pipe((0,p.U)(l=>l?.role))}ngOnInit(){const o=+this.activatedRoute.snapshot.params.id;this.usuario$=this.usuariosService.getUsuarioById$(o);const i=this.usuariosService.getUsuarioWithInscripciones$(o);this.usuario$=i.pipe((0,p.U)(s=>s.usuario)),this.inscripciones$=i.pipe((0,p.U)(s=>s.inscripciones))}eliminarInscripcion(o){o&&this.inscripcionesService.deleteInscripcionUsuario$(o).subscribe(()=>{this.inscripciones$=this.usuariosService.getUsuarioWithInscripciones$(+this.activatedRoute.snapshot.params.id).pipe((0,p.U)(s=>s.inscripciones))})}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(f.gz),t.Y36(C),t.Y36(ot.K),t.Y36(N.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-usuarios-detail"]],decls:3,vars:3,consts:[[1,"container","d-flex","align-items-center","justify-content-center"],[4,"ngIf"],[1,"my-custom-card"],["appTextSize","","fontWeight","normal","fontSize","18px"],["noInscripciones",""],[4,"ngIf","ngIfElse"],[2,"list-style","none"],["class","pt-3",4,"ngFor","ngForOf"],[1,"pt-3"],["fontWeight","bold"],["color","warn",1,"btn","btn-danger","btn-sm",3,"click"],[1,"custom-divider"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0),t.YNc(1,lt,16,11,"div",1),t.ALo(2,"async"),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,s.usuario$)))},dependencies:[c.sg,c.O5,g.a8,g.hq,g.dn,g.dk,g.n5,y.Y,it.d,c.Ov,c.rS,c.uU,Y.k],styles:[".my-custom-card[_ngcontent-%COMP%]{width:100%;max-width:600px;margin:20px;padding:20px;box-shadow:0 4px 8px #0000001a;border-radius:8px}mat-card-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700}mat-card-content[_ngcontent-%COMP%]{font-size:16px}ul[_ngcontent-%COMP%]{padding:0}li[_ngcontent-%COMP%]{margin-bottom:20px}.custom-divider[_ngcontent-%COMP%]{width:90%;margin:0 auto}"]})}return e})()}];let mt=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(ct),f.Bz]})}return e})(),dt=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[c.ez,S.m,f.Bz,mt]})}return e})()}}]);